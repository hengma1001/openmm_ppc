<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>OpenMM::LocalCoordinatesSite Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>OpenMM</b></li><li class="navelem"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html">LocalCoordinatesSite</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classOpenMM_1_1LocalCoordinatesSite-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OpenMM::LocalCoordinatesSite Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="VirtualSite_8h_source.html">VirtualSite.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OpenMM::LocalCoordinatesSite:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classOpenMM_1_1LocalCoordinatesSite.png" usemap="#OpenMM::LocalCoordinatesSite_map" alt=""/>
  <map id="OpenMM::LocalCoordinatesSite_map" name="OpenMM::LocalCoordinatesSite_map">
<area href="classOpenMM_1_1VirtualSite.html" alt="OpenMM::VirtualSite" shape="rect" coords="0,0,191,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f732f41f89eb85d07dd7f9d4af8c383"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a6f732f41f89eb85d07dd7f9d4af8c383">LocalCoordinatesSite</a> (const std::vector&lt; int &gt; &amp;particles, const std::vector&lt; double &gt; &amp;originWeights, const std::vector&lt; double &gt; &amp;xWeights, const std::vector&lt; double &gt; &amp;yWeights, const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;localPosition)</td></tr>
<tr class="separator:a6f732f41f89eb85d07dd7f9d4af8c383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abef9c267c0e379f36d012fb9acd3f764"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#abef9c267c0e379f36d012fb9acd3f764">LocalCoordinatesSite</a> (int particle1, int particle2, int particle3, const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;originWeights, const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;xWeights, const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;yWeights, const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;localPosition)</td></tr>
<tr class="separator:abef9c267c0e379f36d012fb9acd3f764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7475bc470f124a9c33aacc439c8f7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a6a7475bc470f124a9c33aacc439c8f7c">getOriginWeights</a> (std::vector&lt; double &gt; &amp;weights) const </td></tr>
<tr class="separator:a6a7475bc470f124a9c33aacc439c8f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5665c35b003a43a2e60e145eca9f41c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a5665c35b003a43a2e60e145eca9f41c4">getOriginWeights</a> () const </td></tr>
<tr class="separator:a5665c35b003a43a2e60e145eca9f41c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0df2ea1084774f457a653e919553906d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a0df2ea1084774f457a653e919553906d">getXWeights</a> (std::vector&lt; double &gt; &amp;weights) const </td></tr>
<tr class="separator:a0df2ea1084774f457a653e919553906d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad2d8fffded40a6c6935c641e6b41a54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#aad2d8fffded40a6c6935c641e6b41a54">getXWeights</a> () const </td></tr>
<tr class="separator:aad2d8fffded40a6c6935c641e6b41a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f392b8fc84122bb9eabe6c2fa79b93"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a22f392b8fc84122bb9eabe6c2fa79b93">getYWeights</a> (std::vector&lt; double &gt; &amp;weights) const </td></tr>
<tr class="separator:a22f392b8fc84122bb9eabe6c2fa79b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac79080483bc1b3baf663f3a5e357938e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#ac79080483bc1b3baf663f3a5e357938e">getYWeights</a> () const </td></tr>
<tr class="separator:ac79080483bc1b3baf663f3a5e357938e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68968c501f47868c6c69b3dc9389c301"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html#a68968c501f47868c6c69b3dc9389c301">getLocalPosition</a> () const </td></tr>
<tr class="separator:a68968c501f47868c6c69b3dc9389c301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classOpenMM_1_1VirtualSite"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classOpenMM_1_1VirtualSite')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classOpenMM_1_1VirtualSite.html">OpenMM::VirtualSite</a></td></tr>
<tr class="memitem:a2bb6777d75b69c6af7880efb3d304881 inherit pub_methods_classOpenMM_1_1VirtualSite"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1VirtualSite.html#a2bb6777d75b69c6af7880efb3d304881">getNumParticles</a> () const </td></tr>
<tr class="separator:a2bb6777d75b69c6af7880efb3d304881 inherit pub_methods_classOpenMM_1_1VirtualSite"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5474ea1071d3d41970688b18d1dc2ac inherit pub_methods_classOpenMM_1_1VirtualSite"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenMM_1_1VirtualSite.html#aa5474ea1071d3d41970688b18d1dc2ac">getParticle</a> (int particle) const </td></tr>
<tr class="separator:aa5474ea1071d3d41970688b18d1dc2ac inherit pub_methods_classOpenMM_1_1VirtualSite"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classOpenMM_1_1VirtualSite"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classOpenMM_1_1VirtualSite')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classOpenMM_1_1VirtualSite.html">OpenMM::VirtualSite</a></td></tr>
<tr class="memitem:ace9d369cb1809df040f5025c43ef2c0d inherit pro_methods_classOpenMM_1_1VirtualSite"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace9d369cb1809df040f5025c43ef2c0d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setParticles</b> (const std::vector&lt; int &gt; &amp;particleIndices)</td></tr>
<tr class="separator:ace9d369cb1809df040f5025c43ef2c0d inherit pro_methods_classOpenMM_1_1VirtualSite"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is a <a class="el" href="classOpenMM_1_1VirtualSite.html">VirtualSite</a> that uses the locations of several other particles to compute a local coordinate system, then places the virtual site at a fixed location in that coordinate system. The origin of the coordinate system and the directions of its x and y axes are each specified as a weighted sum of the locations of the other particles:</p>
<p>origin = w<sup>o</sup><sub>1</sub>r<sub>1</sub> + w<sup>o</sup><sub>2</sub>r<sub>2</sub> + w<sup>o</sup><sub>3</sub>r<sub>3</sub> + ...</p>
<p>xdir = w<sup>x</sup><sub>1</sub>r<sub>1</sub> + w<sup>x</sup><sub>2</sub>r<sub>2</sub> + w<sup>x</sup><sub>3</sub>r<sub>3</sub> + ...</p>
<p>ydir = w<sup>y</sup><sub>1</sub>r<sub>1</sub> + w<sup>y</sup><sub>2</sub>r<sub>2</sub> + w<sup>y</sup><sub>3</sub>r<sub>3</sub> + ...</p>
<p>For the origin, the weights must add to one. For example if (w<sup>o</sup><sub>1</sub>, w<sup>o</sup><sub>2</sub>, w<sup>o</sup><sub>3</sub>) = (1.0, 0.0, 0.0), the origin of the local coordinate system is at the location of particle 1. For xdir and ydir, the weights must add to zero. For example, if (w<sup>x</sup><sub>1</sub>, w<sup>x</sup><sub>2</sub>, w<sup>x</sup><sub>3</sub>) = (-1.0, 0.5, 0.5), the x axis points from particle 1 toward the midpoint between particles 2 and 3.</p>
<p>The z direction is computed as zdir = xdir x ydir. To ensure the axes are all orthogonal, ydir is then recomputed as ydir = zdir x xdir. All three axis vectors are then normalized, and the virtual site location is set to</p>
<p>origin + x*xdir + y*ydir + z*zdir </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6f732f41f89eb85d07dd7f9d4af8c383"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenMM::LocalCoordinatesSite::LocalCoordinatesSite </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>originWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td>
          <td class="paramname"><em>localPosition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new <a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html">LocalCoordinatesSite</a> virtual site.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td>the indices of the particle the site depends on </td></tr>
    <tr><td class="paramname">originWeights</td><td>the weight factors for the particles when computing the origin location </td></tr>
    <tr><td class="paramname">xWeights</td><td>the weight factors for the particles when computing xdir </td></tr>
    <tr><td class="paramname">yWeights</td><td>the weight factors for the particles when computing ydir </td></tr>
    <tr><td class="paramname">localPosition</td><td>the position of the virtual site in the local coordinate system </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abef9c267c0e379f36d012fb9acd3f764"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenMM::LocalCoordinatesSite::LocalCoordinatesSite </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>particle1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>particle2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>particle3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td>
          <td class="paramname"><em>originWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td>
          <td class="paramname"><em>xWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td>
          <td class="paramname"><em>yWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> &amp;&#160;</td>
          <td class="paramname"><em>localPosition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new <a class="el" href="classOpenMM_1_1LocalCoordinatesSite.html">LocalCoordinatesSite</a> virtual site. This constructor assumes the site depends on exactly three other particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particle1</td><td>the index of the first particle </td></tr>
    <tr><td class="paramname">particle2</td><td>the index of the second particle </td></tr>
    <tr><td class="paramname">particle3</td><td>the index of the third particle </td></tr>
    <tr><td class="paramname">originWeights</td><td>the weight factors for the three particles when computing the origin location </td></tr>
    <tr><td class="paramname">xWeights</td><td>the weight factors for the three particles when computing xdir </td></tr>
    <tr><td class="paramname">yWeights</td><td>the weight factors for the three particles when computing ydir </td></tr>
    <tr><td class="paramname">localPosition</td><td>the position of the virtual site in the local coordinate system </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a68968c501f47868c6c69b3dc9389c301"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a>&amp; OpenMM::LocalCoordinatesSite::getLocalPosition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the position of the virtual site in the local coordinate system. </p>

</div>
</div>
<a class="anchor" id="a6a7475bc470f124a9c33aacc439c8f7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenMM::LocalCoordinatesSite::getOriginWeights </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weights</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing the origin location. </p>

</div>
</div>
<a class="anchor" id="a5665c35b003a43a2e60e145eca9f41c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> OpenMM::LocalCoordinatesSite::getOriginWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing the origin location. This version assumes the site depends on exactly three other particles, and throws an exception if that is not the case. </p>

</div>
</div>
<a class="anchor" id="a0df2ea1084774f457a653e919553906d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenMM::LocalCoordinatesSite::getXWeights </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weights</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing xdir. </p>

</div>
</div>
<a class="anchor" id="aad2d8fffded40a6c6935c641e6b41a54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> OpenMM::LocalCoordinatesSite::getXWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing xdir. This version assumes the site depends on exactly three other particles, and throws an exception if that is not the case. </p>

</div>
</div>
<a class="anchor" id="a22f392b8fc84122bb9eabe6c2fa79b93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenMM::LocalCoordinatesSite::getYWeights </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weights</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing ydir. </p>

</div>
</div>
<a class="anchor" id="ac79080483bc1b3baf663f3a5e357938e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenMM_1_1Vec3.html">Vec3</a> OpenMM::LocalCoordinatesSite::getYWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight factors for the particles when computing ydir. This version assumes the site depends on exactly three other particles, and throws an exception if that is not the case. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/ccs/home/hm0/Pkgs/openmm/openmmapi/include/openmm/<a class="el" href="VirtualSite_8h_source.html">VirtualSite.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
